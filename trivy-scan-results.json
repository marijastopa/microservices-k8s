{
  "SchemaVersion": 2,
  "Trivy": {
    "Version": "0.69.1"
  },
  "ReportID": "019c5748-dfa6-79a4-909b-ae2fc2fa93e8",
  "CreatedAt": "2026-02-13T14:55:19.590635+01:00",
  "ArtifactName": "k8s",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": "deployments/adservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'adservice' of Deployment 'adservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: adservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: adservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 9555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"9555\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"9555\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'adservice' of Deployment 'adservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: adservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: adservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 9555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"9555\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"9555\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"adservice\" of deployment \"adservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: adservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: adservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 9555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"9555\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"9555\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container adservice in deployment adservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: adservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: adservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/adservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 9555",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9555",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"9555\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"9555\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/cartservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'cartservice' of Deployment 'cartservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: cartservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: cartservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7070",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7070",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: ASPNETCORE_HTTP_PORTS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ASPNETCORE_HTTP_PORTS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7070\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7070\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'cartservice' of Deployment 'cartservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: cartservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: cartservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7070",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7070",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: ASPNETCORE_HTTP_PORTS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ASPNETCORE_HTTP_PORTS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7070\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7070\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"cartservice\" of deployment \"cartservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: cartservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: cartservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7070",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7070",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: ASPNETCORE_HTTP_PORTS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ASPNETCORE_HTTP_PORTS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7070\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7070\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container cartservice in deployment cartservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: cartservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: cartservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/cartservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7070",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7070",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: ASPNETCORE_HTTP_PORTS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ASPNETCORE_HTTP_PORTS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7070\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7070\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/checkoutservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'checkoutservice' of Deployment 'checkoutservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: checkoutservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: checkoutservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5050",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5050",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"5050\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"5050\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'checkoutservice' of Deployment 'checkoutservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: checkoutservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: checkoutservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5050",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5050",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"5050\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"5050\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"checkoutservice\" of deployment \"checkoutservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: checkoutservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: checkoutservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5050",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5050",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"5050\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"5050\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container checkoutservice in deployment checkoutservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: checkoutservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: checkoutservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/checkoutservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 5050",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5050",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"5050\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"5050\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/currencyservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'currencyservice' of Deployment 'currencyservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: currencyservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: currencyservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7000\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7000\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'currencyservice' of Deployment 'currencyservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: currencyservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: currencyservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7000\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7000\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"currencyservice\" of deployment \"currencyservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: currencyservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: currencyservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7000\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7000\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container currencyservice in deployment currencyservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: currencyservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: currencyservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/currencyservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 7000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m7000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"7000\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"7000\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/emailservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'emailservice' of Deployment 'emailservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: emailservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: emailservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'emailservice' of Deployment 'emailservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: emailservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: emailservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"emailservice\" of deployment \"emailservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: emailservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: emailservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container emailservice in deployment emailservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: emailservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: emailservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/emailservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/frontend.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'frontend' of Deployment 'frontend' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: frontend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'frontend' of Deployment 'frontend' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: frontend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"frontend\" of deployment \"frontend\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: frontend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container frontend in deployment frontend (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: frontend",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/frontend:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/paymentservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'paymentservice' of Deployment 'paymentservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: paymentservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: paymentservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'paymentservice' of Deployment 'paymentservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: paymentservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: paymentservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"paymentservice\" of deployment \"paymentservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: paymentservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: paymentservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container paymentservice in deployment paymentservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: paymentservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: paymentservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/paymentservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: DISABLE_PROFILER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DISABLE_PROFILER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"1\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/productcatalogservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'productcatalogservice' of Deployment 'productcatalogservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: productcatalogservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: productcatalogservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 3550",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3550",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"3550\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'productcatalogservice' of Deployment 'productcatalogservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: productcatalogservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: productcatalogservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 3550",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3550",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"3550\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"productcatalogservice\" of deployment \"productcatalogservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: productcatalogservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: productcatalogservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 3550",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3550",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"3550\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container productcatalogservice in deployment productcatalogservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: productcatalogservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: productcatalogservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/productcatalogservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 3550",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3550",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"3550\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/recommendationservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'recommendationservice' of Deployment 'recommendationservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: recommendationservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: recommendationservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'recommendationservice' of Deployment 'recommendationservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: recommendationservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: recommendationservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"recommendationservice\" of deployment \"recommendationservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: recommendationservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: recommendationservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container recommendationservice in deployment recommendationservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: recommendationservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: recommendationservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/recommendationservice:v3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"8080\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"8080\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        - name: PRODUCT_CATALOG_SERVICE_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PRODUCT_CATALOG_SERVICE_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          value: \"productcatalogservice:3550\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"productcatalogservice:3550\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployments/shippingservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'shippingservice' of Deployment 'shippingservice' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: shippingservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: shippingservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'shippingservice' of Deployment 'shippingservice' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: shippingservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: shippingservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"shippingservice\" of deployment \"shippingservice\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: shippingservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: shippingservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container shippingservice in deployment shippingservice (namespace: default) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv-0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: shippingservice",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: shippingservice",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: europe-west1-docker.pkg.dev/microservices-gke-486922/microservices/shippingservice:v1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 50051",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m50051",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        - name: PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PORT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          value: \"50051\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"50051\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "hpa/checkoutservice-hpa.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "hpa/frontend-hpa.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "hpa/recommendationservice-hpa.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "ingress/frontend-ingress.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "networkpolicies/backend-allow-internal.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "networkpolicies/deny-from-other-namespaces.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "networkpolicies/frontend-allow-external.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/adservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/cartservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/checkoutservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/currencyservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/emailservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/frontend.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/paymentservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/productcatalogservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/recommendationservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    },
    {
      "Target": "services/shippingservice.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 39,
        "Failures": 0
      }
    }
  ]
}
